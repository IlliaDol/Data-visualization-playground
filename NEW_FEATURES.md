# üöÄ –ù–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó DataViz AI

## üìä Permalinks + Share/Fork

### –©–æ —Ü–µ?
–°–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω—å –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫–∏ —Ç–∞ —ó—Ö —à–∞—Ä–∏–Ω–≥—É. –ö–æ–∂–µ–Ω –≥—Ä–∞—Ñ—ñ–∫ –º–æ–∂–µ –±—É—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π —è–∫ URL, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å –≤—Å—ñ –¥–∞–Ω—ñ —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è.

### –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ `/q` –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ —á–µ—Ä–µ–∑ NLQ
2. –í–≤–µ–¥—ñ—Ç—å –∑–∞–ø–∏—Ç –ø—Ä–∏—Ä–æ–¥–Ω–æ—é –º–æ–≤–æ—é (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: "–ü–æ–∫–∞–∂–∏ –ø—Ä–æ–¥–∞–∂—ñ –ø–æ –º—ñ—Å—è—Ü—è—Ö")
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è" –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è
4. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ "Fork" –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–ø—ñ—ó –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ

### –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `lz-string` –¥–ª—è —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è —Å—Ç–∞–Ω—É
- –ö–æ–¥—É—î `ChartSpec` + –¥–∞–Ω—ñ –≤ URL
- –ü—ñ–¥—Ç—Ä–∏–º—É—î –º–∞—Å–∫—É–≤–∞–Ω–Ω—è PII –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–∏—Ö –¥–∞–Ω–∏—Ö

---

## üßπ Fix my data (–ê–≥–µ–Ω—Ç-–æ—á–∏—Å–Ω–∏–∫)

### –©–æ —Ü–µ?
–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ—á–∏—â–µ–Ω–Ω—è —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–∏—Ö. –ê–Ω–∞–ª—ñ–∑—É—î –≤–∞—à—ñ –¥–∞–Ω—ñ —Ç–∞ –ø—Ä–æ–ø–æ–Ω—É—î –ø–ª–∞–Ω —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ–π.

### –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥–∞–Ω—ñ –Ω–∞ –≥–æ–ª–æ–≤–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É "–í–∏–ø—Ä–∞–≤–∏—Ç–∏ –¥–∞–Ω—ñ"
3. –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ø–ª–∞–Ω –æ—á–∏—â–µ–Ω–Ω—è
4. –ó–∞—Å—Ç–æ—Å—É–π—Ç–µ –∑–º—ñ–Ω–∏ –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –æ—á–∏—â–µ–Ω–∏–π CSV

### –©–æ —Ä–æ–±–∏—Ç—å:
- **–î–µ—Ç–µ–∫—Ç—É—î —Ç–∏–ø–∏ –¥–∞–Ω–∏—Ö**: —á–∏—Å–ª–∞, –¥–∞—Ç–∏, –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
- **–ù–æ—Ä–º–∞–ª—ñ–∑—É—î —Ñ–æ—Ä–º–∞—Ç–∏**: –¥–µ—Å—è—Ç–∫–æ–≤—ñ —Ä–æ–∑–¥—ñ–ª—é–≤–∞—á—ñ, —á–∞—Å–æ–≤—ñ —Ñ–æ—Ä–º–∞—Ç–∏
- **–í–∏–¥–∞–ª—è—î –¥—É–±–ª—ñ–∫–∞—Ç–∏**: –∑–Ω–∞—Ö–æ–¥–∏—Ç—å —Ç–∞ –≤–∏–¥–∞–ª—è—î –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω—ñ —Ä—è–¥–∫–∏
- **–û—á–∏—â—É—î –ø—Ä–æ–±—ñ–ª–∏**: –≤–∏–¥–∞–ª—è—î –∑–∞–π–≤—ñ –ø—Ä–æ–±—ñ–ª–∏ —Ç–∞ —Å–∏–º–≤–æ–ª–∏

### –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Apache Arrow –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏
- –õ–æ–∫–∞–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ (–±–µ–∑ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä)
- –ü—ñ–¥—Ç—Ä–∏–º—É—î –≤–µ–ª–∏–∫—ñ —Ñ–∞–π–ª–∏

---

## üìà ChartSpec + Vega-Lite

### –©–æ —Ü–µ?
–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–∞ —Å—Ö–µ–º–∞ –¥–ª—è –æ–ø–∏—Å—É –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ —Ç–∞ —Ä–µ–Ω–¥–µ—Ä–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤—ñ Vega-Lite.

### –ü–µ—Ä–µ–≤–∞–≥–∏:
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü—ñ—è**: —î–¥–∏–Ω–∞ —Å—Ö–µ–º–∞ –¥–ª—è –≤—Å—ñ—Ö –≥—Ä–∞—Ñ—ñ–∫—ñ–≤
- **–í–∞–ª—ñ–¥–∞—Ü—ñ—è**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ—Ä–µ–∫—Ç–Ω–æ—Å—Ç—ñ
- **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å**: –ª–µ–≥–∫–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö —Ç–∏–ø—ñ–≤
- **–°—É–º—ñ—Å–Ω—ñ—Å—Ç—å**: –ø—Ä–∞—Ü—é—î –∑ —ñ—Å–Ω—É—é—á–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

### –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ —Ç–∏–ø–∏ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤:
- Bar (—Å—Ç–æ–≤–ø—á–∏–∫–æ–≤—ñ)
- Line (–ª—ñ–Ω—ñ–π–Ω—ñ)
- Point (—Ç–æ—á–∫–æ–≤—ñ)
- Area (–æ–±–ª–∞—Å—Ç—ñ)
- Heatmap (—Ç–µ–ø–ª–æ–≤—ñ –∫–∞—Ä—Ç–∏)
- Pie (–∫—Ä—É–≥–æ–≤—ñ)
- Treemap (–¥–µ—Ä–µ–≤–æ–≤–∏–¥–Ω—ñ –∫–∞—Ä—Ç–∏)
- Sankey (–¥—ñ–∞–≥—Ä–∞–º–∏ –°–∞–Ω–∫—ñ)

---

## üåê Chrome —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è "Chart anything"

### –©–æ —Ü–µ?
–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞, —è–∫–µ –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –≥—Ä–∞—Ñ—ñ–∫–∏ –∑ –±—É–¥—å-—è–∫–∏—Ö —Ç–∞–±–ª–∏—Ü—å –Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö.

### –Ø–∫ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏:
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ `chrome://extensions/`
2. –£–≤—ñ–º–∫–Ω—ñ—Ç—å "–†–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞"
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è"
4. –í–∏–±–µ—Ä—ñ—Ç—å –ø–∞–ø–∫—É `chrome-extension/`

### –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –∑ —Ç–∞–±–ª–∏—Ü–µ—é
2. –ö–ª—ñ–∫–Ω—ñ—Ç—å –ø—Ä–∞–≤–æ—é –∫–Ω–æ–ø–∫–æ—é –Ω–∞ —Ç–∞–±–ª–∏—Ü—ñ
3. –í–∏–±–µ—Ä—ñ—Ç—å "Open in DataViz AI"
4. –î–∞–Ω—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ–º–ø–æ—Ä—Ç—É—é—Ç—å—Å—è –≤ –¥–æ–¥–∞—Ç–æ–∫

### –§—É–Ω–∫—Ü—ñ—ó:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è –Ω–∞–π–±—ñ–ª—å—à–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è HTML —Ç–∞–±–ª–∏—Ü—å –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ
- –ë–µ–∑–ø–µ—á–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ URL
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤—Å—ñ—Ö —Ç–∏–ø—ñ–≤ —Ç–∞–±–ª–∏—Ü—å

---

## üîß –¢–µ—Ö–Ω—ñ—á–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

### –ù–æ–≤—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:
```json
{
  "vega": "^5.25.0",
  "vega-embed": "^6.21.0", 
  "vega-lite": "^5.8.0",
  "apache-arrow": "^14.0.0",
  "lz-string": "^1.5.0",
  "nanoid": "^5.0.0"
}
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤:
```
lib/
‚îú‚îÄ‚îÄ permalink.ts      # –£—Ç–∏–ª—ñ—Ç–∏ –¥–ª—è permalinks
‚îú‚îÄ‚îÄ render.ts         # Vega-Lite —Ä–µ–Ω–¥–µ—Ä–µ—Ä
‚îú‚îÄ‚îÄ cleaner.ts        # –ê–≥–µ–Ω—Ç-–æ—á–∏—Å–Ω–∏–∫ –¥–∞–Ω–∏—Ö
‚îî‚îÄ‚îÄ nlq.ts           # NLQ –∞–≥–µ–Ω—Ç

components/
‚îú‚îÄ‚îÄ DataCleaner.tsx   # UI –¥–ª—è –æ—á–∏—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
‚îî‚îÄ‚îÄ ShareFork.tsx     # UI –¥–ª—è —à–∞—Ä–∏–Ω–≥—É

app/
‚îú‚îÄ‚îÄ q/page.tsx        # –°—Ç–æ—Ä—ñ–Ω–∫–∞ NLQ
‚îî‚îÄ‚îÄ import/page.tsx   # –°—Ç–æ—Ä—ñ–Ω–∫–∞ —ñ–º–ø–æ—Ä—Ç—É

chrome-extension/
‚îú‚îÄ‚îÄ manifest.json     # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
‚îú‚îÄ‚îÄ bg.js            # Background script
‚îú‚îÄ‚îÄ popup.html       # Popup —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îî‚îÄ‚îÄ popup.js         # Popup –ª–æ–≥—ñ–∫–∞
```

### API —Å—Ö–µ–º–∏:
```typescript
// ChartSpec (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–∞ —Å—Ö–µ–º–∞)
export type ChartSpecV1 = {
  version: '1';
  data: { id?: string; values?: any[] };
  transforms?: Transform[];
  encoding: {
    x?: EncodingField;
    y?: EncodingField;
    color?: EncodingField;
    size?: EncodingField;
    tooltip?: TooltipField[];
  };
  mark: ChartType;
  title?: string;
  meta: {
    datasetHash?: string;
    createdAt: string;
    prompt?: string;
  };
}

// Transform (–¥–ª—è –æ—á–∏—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö)
export type Transform =
  | { op: 'setType'; field: string; to: 'date'|'number'|'string' }
  | { op: 'parseDate'; field: string; pattern: 'auto'|string }
  | { op: 'normalizeDecimal'; field: string; decimal: '.'|','; thousands?: '.'|',' | ' ' }
  | { op: 'trim'; field: string }
  | { op: 'dropDuplicates'; subset?: string[] };
```

---

## üéØ –ú–µ—Ç—Ä–∏–∫–∏ —Ç–∞ KPI

### Permalinks:
- `nlq_prompt_started` - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤
- `nlq_chart_rendered` - —É—Å–ø—ñ—à–Ω–∏—Ö —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—ñ–≤
- `nlq_share_clicked` - –∫–ª—ñ–∫–∏ –ø–æ —à–∞—Ä–∏–Ω–≥—É
- `nlq_fork_clicked` - –∫–ª—ñ–∫–∏ –ø–æ fork

### Data Cleaner:
- `clean_plan_shown` - –ø–æ–∫–∞–∑–∞–Ω–∏—Ö –ø–ª–∞–Ω—ñ–≤
- `clean_applied` - –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–∏—Ö –æ—á–∏—â–µ–Ω—å
- `import_fail_rate` - —á–∞—Å—Ç–æ—Ç–∞ –ø–æ–º–∏–ª–æ–∫ —ñ–º–ø–æ—Ä—Ç—É

### Chrome Extension:
- `ext_install` - –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—å
- `ext_import_started` - –ø–æ—á–∞—Ç–∏—Ö —ñ–º–ø–æ—Ä—Ç—ñ–≤
- `ext_import_success` - —É—Å–ø—ñ—à–Ω–∏—Ö —ñ–º–ø–æ—Ä—Ç—ñ–≤

---

## üöÄ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 1 (–Ω–∞–π–≤–∏—â–∏–π):
1. **–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —Ä–µ–∞–ª—å–Ω–∏–º AI** –¥–ª—è NLQ
2. **–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞** Vega-Lite
3. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è** –≤—Å—ñ—Ö —Ñ—É–Ω–∫—Ü—ñ–π

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 2:
1. **Auto-Report Agent** (–∞–≤—Ç–æ–∑–≤—ñ—Ç–∏)
2. **–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è Chrome —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è**
3. **–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞** —Ç–∞ –º–µ—Ç—Ä–∏–∫–∏

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 3:
1. **–î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ç–∏–ø–∏ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤**
2. **–ï–∫—Å–ø–æ—Ä—Ç –≤ —Ä—ñ–∑–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏**
3. **–ö–æ–ªaborative features**

---

## üêõ –í—ñ–¥–æ–º—ñ –ø—Ä–æ–±–ª–µ–º–∏

1. **Apache Arrow**: –º–æ–∂–µ –±—É—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏ –∑ –≤–µ–ª–∏–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏
2. **Vega-Lite**: –¥–µ—è–∫—ñ —Å–∫–ª–∞–¥–Ω—ñ –≥—Ä–∞—Ñ—ñ–∫–∏ –º–æ–∂—É—Ç—å –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç–∏—Å—è
3. **Chrome Extension**: –ø–æ—Ç—Ä–µ–±—É—î —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö —Å–∞–π—Ç–∞—Ö

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–Ø–∫—â–æ —É –≤–∞—Å —î –ø–∏—Ç–∞–Ω–Ω—è –∞–±–æ –ø—Ä–æ–±–ª–µ–º–∏:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –ø–æ–º–∏–ª–∫–∏
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤—Å—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ
3. –°–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ dev —Å–µ—Ä–≤–µ—Ä

---

*–û–Ω–æ–≤–ª–µ–Ω–æ: ${new Date().toLocaleDateString()}*
